!function(n){if("function"==typeof bootstrap)bootstrap("sjj",n);else if("object"==typeof exports)module.exports=n();else if("function"==typeof define&&define.amd)define(n);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeSJJ=n}else"undefined"!=typeof window?window.SJJ=n():global.SJJ=n()}(function(){return function n(r,e,t){function i(a,o){if(!e[a]){if(!r[a]){var u="function"==typeof require&&require;if(!o&&u)return u(a,!0);if(s)return s(a,!0);throw new Error("Cannot find module '"+a+"'")}var p=e[a]={exports:{}};r[a][0].call(p.exports,function(n){var e=r[a][1][n];return i(e?e:n)},p,p.exports,n,r,e,t)}return e[a].exports}for(var s="function"==typeof require&&require,a=0;a<t.length;a++)i(t[a]);return i}({1:[function(n,r,e){var t=n("./lib/tosdp"),i=n("./lib/tojson");e.toSessionSDP=t.toSessionSDP,e.toMediaSDP=t.toMediaSDP,e.toCandidateSDP=t.toCandidateSDP,e.toSessionJSON=i.toSessionJSON,e.toMediaJSON=i.toMediaJSON,e.toCandidateJSON=i.toCandidateJSON},{"./lib/tojson":3,"./lib/tosdp":4}],2:[function(n,r,e){e.lines=function(n){return n.split("\r\n").filter(function(n){return n.length>0})},e.findLine=function(n,r,e){for(var t=n.length,i=0;i<r.length;i++)if(r[i].substr(0,t)===n)return r[i];if(!e)return!1;for(var s=0;s<e.length;s++)if(e[s].substr(0,t)===n)return e[s];return!1},e.findLines=function(n,r){for(var e=[],t=n.length,i=0;i<r.length;i++)r[i].substr(0,t)===n&&e.push(r[i]);return e},e.mline=function(n){for(var r=n.substr(2).split(" "),e={media:r[0],port:r[1],proto:r[2],formats:[]},t=3;t<r.length;t++)r[t]&&e.formats.push(r[t]);return e},e.rtpmap=function(n){var r=n.substr(9).split(" "),e={id:r.shift()};return r=r[0].split("/"),e.name=r[0],e.clockrate=r[1],e.channels=3==r.length?r[2]:"1",e},e.fmtp=function(n){for(var r,e,t,i=n.substr(n.indexOf(" ")+1).split(";"),s=[],a=0;a<i.length;a++)r=i[a].split("="),e=r[0].trim(),t=r[1],e&&t?s.push({key:e,value:t}):e&&s.push({key:"",value:e});return s},e.crypto=function(n){var r=n.substr(9).split(" "),e={tag:r[0],cipherSuite:r[1],keyParams:r[2],sessionParams:r.slice(3).join(" ")};return e},e.fingerprint=function(n){var r=n.substr(14).split(" ");return{hash:r[0],value:r[1]}},e.extmap=function(n){var r=n.substr(9).split(" "),e={},t=r.shift(),i=t.indexOf("/");return i>=0?(e.id=t.substr(0,i),e.senders=t.substr(i)):(e.id=t,e.senders="sendrecv"),e.uri=r.shift(),e},e.rtcpfb=function(n){var r=n.substr(10).split(" "),e={};return e.id=r.shift(),e.type=r.shift(),"trr-int"===e.type?e.value=r.shift():e.subtype=r.shift(),e.parameters=r,e},e.candidate=function(n){for(var r=n.substring(12).split(" "),e={foundation:r[0],component:r[1],protocol:r[2].toLowerCase(),priority:r[3],ip:r[4],port:r[5],type:r[7]},t=8;t<r.length;t+=2)"raddr"===r[t]?e.relAddr=r[t+1]:"rport"===r[t]?e.relPort=r[t+1]:"generation"===r[t]&&(e.generation=r[t+1]);return e.network="1",e},e.ssrc=function(n){for(var r,e,t=[],i={},s=0;s<n.length;s++){r=n[s].substr(7).split(" "),e=r.shift(),r=r.join(" ").split(":");var a=r.shift(),o=r.join(":")||null;i[e]||(i[e]={}),i[e][a]=o}for(e in i){var u=i[e];u.ssrc=e,t.push(u)}return t},e.grouping=function(n){for(var r,e=[],t=0;t<n.length;t++)r=n[t].substr(8).split(" "),e.push({semantics:r.shift(),contents:r});return e}},{}],3:[function(n,r,e){var t=n("./parsers"),i=Math.random();e.toSessionJSON=function(n,r){for(var i=n.split("\r\nm="),s=1;s<i.length;s++)i[s]="m="+i[s],s!==i.length-1&&(i[s]+="\r\n");var a=i.shift()+"\r\n",o=t.lines(a),u={},p=[];i.forEach(function(n){p.push(e.toMediaJSON(n,a,r))}),u.contents=p;var f=t.findLines("a=group:",o);return f.length&&(u.groupings=t.grouping(f)),u},e.toMediaJSON=function(n,r,i){var s=t.lines(n),a=t.lines(r),o=t.mline(s[0]),u={creator:i,name:o.media,description:{descType:"rtp",media:o.media,payloads:[],encryption:[],feedback:[],headerExtensions:[]},transport:{transType:"iceUdp"}},p=u.description,f=u.transport,c=t.findLine("a=ssrc:",s);c&&(p.ssrc=c.substr(7).split(" ")[0]);var d=t.findLine("a=mid:",s);d&&(u.name=d.substr(6)),t.findLine("a=sendrecv",s,a)?u.senders="both":t.findLine("a=sendonly",s,a)?u.senders="initiator":t.findLine("a=recvonly",s,a)?u.senders="responder":t.findLine("a=inactive",s,a)&&(u.senders="none");var h=t.findLines("a=rtpmap:",s);h.forEach(function(n){var r=t.rtpmap(n);r.feedback=[];var e=t.findLines("a=fmtp:"+r.id,s);e.forEach(function(n){r.parameters=t.fmtp(n)});var i=t.findLines("a=rtcp-fb:"+r.id,s);i.forEach(function(n){r.feedback.push(t.rtcpfb(n))}),p.payloads.push(r)});var l=t.findLines("a=crypto:",s,a);l.forEach(function(n){p.encryption.push(t.crypto(n))}),t.findLine("a=rtcp-mux",s)&&(p.mux=!0);var v=t.findLines("a=rtcp-fb:*",s);v.forEach(function(n){p.feedback.push(t.rtcpfb(n))});var m=t.findLines("a=extmap:",s);m.forEach(function(n){var r=t.extmap(n),e={sendonly:"responder",recvonly:"initiator",sendrecv:"both",inactive:"none"};r.senders=e[r.senders],p.headerExtensions.push(r)});var b=t.findLines("a=ssrc:",s);b.length&&(p.ssrcs=t.ssrc(b));var y=t.findLine("a=fingerprint:",s,a);y&&(f.fingerprint=t.fingerprint(y));var g=t.findLine("a=ice-ufrag:",s,a),S=t.findLine("a=ice-pwd:",s,a);if(g&&S){f.ufrag=g.substr(12),f.pwd=S.substr(10),f.candidates=[];var P=t.findLines("a=candidate:",s,a);P.forEach(function(n){f.candidates.push(e.toCandidateJSON(n))})}return u},e.toCandidateJSON=function(n){var r=t.candidate(n);return r.id=(i++).toString(36).substr(0,12),r}},{"./parsers":2}],4:[function(n,r,e){var t={initiator:"sendonly",responder:"recvonly",both:"sendrecv",none:"inactive",sendonly:"initator",recvonly:"responder",sendrecv:"both",inactive:"none"};e.toSessionSDP=function(n){var r=["v=0","o=- "+(n.sid||Date.now())+" 2 IN IP4 0.0.0.0","s=-","t=0 0"],t=n.groupings||[];t.forEach(function(n){r.push("a=group:"+n.semantics+" "+n.contents.join(" "))});var i=n.contents||[];return i.forEach(function(n){r.push(e.toMediaSDP(n))}),r.join("\r\n")+"\r\n"},e.toMediaSDP=function(n){var r=[],i=n.description,s=n.transport,a=i.payloads||[],o=[i.media,"1"];if(i.encryption&&i.encryption.length>0||s&&s.fingerprint?o.push("RTP/SAVPF"):o.push("RTP/AVPF"),a.forEach(function(n){o.push(n.id)}),r.push("m="+o.join(" ")),r.push("c=IN IP4 0.0.0.0"),r.push("a=rtcp:1 IN IP4 0.0.0.0"),s&&(s.ufrag&&r.push("a=ice-ufrag:"+s.ufrag),s.pwd&&r.push("a=ice-pwd:"+s.pwd),s.fingerprint)){var u=s.fingerprint;r.push("a=fingerprint:"+u.hash+" "+u.value)}r.push("a="+(t[n.senders]||"sendrecv")),r.push("a=mid:"+n.name),i.mux&&r.push("a=rtcp-mux");var p=i.encryption||[];p.forEach(function(n){r.push("a=crypto:"+n.tag+" "+n.cipherSuite+" "+n.keyParams+" "+n.sessionParams)}),a.forEach(function(n){var e="a=rtpmap:"+n.id+" "+n.name+"/"+n.clockrate;if(n.channels&&"1"!=n.channels&&(e+="/"+n.channels),r.push(e),n.parameters&&n.parameters.length){var t=["a=fmtp:"+n.id];n.parameters.forEach(function(n){t.push((n.key?n.key+"=":"")+n.value)}),r.push(t.join(" "))}n.feedback&&n.feedback.forEach(function(e){"trr-int"===e.type?r.push("a=rtcp-fb:"+n.id+" trr-int "+e.value?e.value:"0"):r.push("a=rtcp-fb:"+n.id+" "+e.type+(e.subtype?" "+e.subtype:""))})}),i.feedback&&i.feedback.forEach(function(n){"trr-int"===n.type?r.push(n.value):r.push("a=rtcp-fb:* "+n.type+(n.subtype?" "+n.subtype:""))});var f=i.headerExtensions||[];f.forEach(function(n){r.push("a=extmap:"+n.id+(n.senders?"/"+t[n.senders]:"")+" "+n.uri)});var c=i.ssrcs||[];c.forEach(function(n){for(var e in n)"ssrc"!=e&&r.push("a=ssrc:"+n.ssrc+" "+e+(n[e]?":"+n[e]:""))});var d=s.candidates||[];return d.forEach(function(n){r.push(e.toCandidateSDP(n))}),r.join("\r\n")},e.toCandidateSDP=function(n){var r=[];r.push(n.foundation),r.push(n.component),r.push(n.protocol),r.push(n.priority),r.push(n.ip),r.push(n.port);var e=n.type;return r.push("type"),r.push(e),("srflx"===e||"prflx"===e||"relay"===e)&&n.relAddr&&n.relPort&&(r.push("raddr"),r.push(n.relAddr),r.push("rport"),r.push(n.relPort)),r.push("generation"),r.push(n.generation||"0"),"a=candidate:"+r.join(" ")}},{}]},{},[1])(1)});